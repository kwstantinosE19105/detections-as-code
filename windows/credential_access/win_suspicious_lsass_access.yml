title: Suspicious Access to LSASS (Credential Dumping / Memory Read)
id: 7d5f7e2b-1c7a-4e7a-9b3b-8f6f4bdf2d8a
status: experimental
    Detects processes accessing LSASS with suspicious access rights (often used for credential dumping).
    Primary signal is Sysmon Event ID 10 (ProcessAccess) targeting lsass.exe.
references:
- https://learn.microsoft.com/sysinternals/downloads/sysmon
- https://attack.mitre.org/techniques/T1003/001/
tags:
  - attack.credential_access
  - attack.t1003.001
  - attack.t1003
logsource:
  product: windows
  service: sysmon
  definition: 'Requires Sysmon EventID 10 (ProcessAccess)'

detection:
  selection_target:
    EventID: 10
    TargetImage|endswith: '\lsass.exe'

selection_access_hex:
  GrantedAccess|contains:
    - '0x1410'   # often seen for LSASS read by tools
    - '0x1010'
    - '0x143a'
    - '0x1fffff' # PROCESS_ALL_ACCESS
    - '0x1f0fff' # PROCESS_ALL_ACCESS (alt)
    - '0x0010'   # VM_READ (may be too broad alone, but useful in combo)
    - '0x0400'   # QUERY_INFORMATION
    - '0x0800'   # QUERY_LIMITED_INFORMATION

    
